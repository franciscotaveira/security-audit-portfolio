import React from 'react';
import type { Vulnerability } from '../data/vulnerabilities';

interface VulnerabilityCardProps {
    vulnerability: Vulnerability;
    onClick: (vulnerability: Vulnerability) => void;
}

const severityBadgeClass = {
    critical: 'badge-danger',
    high: 'badge-warning',
    medium: 'badge-info',
    low: 'badge-success',
};

export const VulnerabilityCard: React.FC<VulnerabilityCardProps> = ({
    vulnerability,
    onClick
}) => {
    return (
        <div
            className="glass-card owasp-card"
            onClick={() => onClick(vulnerability)}
            role="button"
            tabIndex={0}
            onKeyPress={(e) => e.key === 'Enter' && onClick(vulnerability)}
        >
            <div className="owasp-card-header">
                <div className="owasp-card-icon">
                    {vulnerability.icon}
                </div>
                <div>
                    <div className="owasp-card-number">{vulnerability.category}</div>
                    <h3 className="owasp-card-title">{vulnerability.title}</h3>
                </div>
            </div>

            <p className="owasp-card-description">
                {vulnerability.description.substring(0, 120)}...
            </p>

            <div className="owasp-card-footer">
                <span className={`badge ${severityBadgeClass[vulnerability.severity]}`}>
                    {vulnerability.severity.toUpperCase()}
                </span>
                <span className="badge badge-purple">
                    {vulnerability.cwe}
                </span>
                <span className="badge badge-info">
                    {vulnerability.testCount} tests
                </span>
            </div>
        </div>
    );
};

export default VulnerabilityCard;
